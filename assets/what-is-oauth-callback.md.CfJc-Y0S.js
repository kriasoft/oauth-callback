import{_ as p,C as k,c,o as e,a2 as o,b as l,j as t,w as i,a,G as r,a3 as h}from"./chunks/framework.B4Qey3Xv.js";const C=JSON.parse('{"title":"What is OAuth Callback?","description":"Learn how OAuth Callback simplifies OAuth 2.0 authorization code capture for CLI tools, desktop apps, and MCP clients using localhost callbacks.","frontmatter":{"title":"What is OAuth Callback?","description":"Learn how OAuth Callback simplifies OAuth 2.0 authorization code capture for CLI tools, desktop apps, and MCP clients using localhost callbacks."},"headers":[],"relativePath":"what-is-oauth-callback.md","filePath":"what-is-oauth-callback.md"}'),d={name:"what-is-oauth-callback.md"};function u(g,s,E,y,A,m){const n=k("Mermaid");return e(),c("div",null,[s[4]||(s[4]=o('<h1 id="top" tabindex="-1">What is OAuth Callback? <a class="header-anchor" href="#top" aria-label="Permalink to &quot;What is OAuth Callback? {#top}&quot;">​</a></h1><p>An OAuth callback is the mechanism that allows OAuth 2.0 authorization servers to return authorization codes to your application after user authentication. For native applications like CLI tools, desktop apps, and MCP clients, receiving this callback requires spinning up a temporary HTTP server on localhost — a process that <strong>OAuth Callback</strong> makes trivially simple with just one function call.</p><p><strong>OAuth Callback</strong> is designed for developers building CLI tools, desktop applications, automation scripts, and Model Context Protocol (MCP) clients that need to capture OAuth authorization codes via a localhost callback. Whether you&#39;re automating workflows across services (Notion, Linear, GitHub), building developer tools, or creating MCP-enabled applications, <strong>OAuth Callback</strong> handles the complexity of the loopback redirect flow recommended by <a href="https://www.rfc-editor.org/rfc/rfc8252.html" target="_blank" rel="noreferrer">RFC 8252</a> while providing modern features like Dynamic Client Registration and flexible token storage — all with support for Node.js 18+, Deno, and Bun.</p><h2 id="understanding-oauth-callbacks" tabindex="-1">Understanding OAuth Callbacks <a class="header-anchor" href="#understanding-oauth-callbacks" aria-label="Permalink to &quot;Understanding OAuth Callbacks&quot;">​</a></h2><h3 id="what-is-a-callback-url-in-oauth-2-0" tabindex="-1">What is a Callback URL in OAuth 2.0? <a class="header-anchor" href="#what-is-a-callback-url-in-oauth-2-0" aria-label="Permalink to &quot;What is a Callback URL in OAuth 2.0?&quot;">​</a></h3><p>In the OAuth 2.0 authorization code flow, the callback URL (also called redirect URI) is where the authorization server sends the user&#39;s browser after they approve or deny your application&#39;s access request. This URL receives critical information:</p><ul><li><strong>On success</strong>: An authorization <code>code</code> parameter that your app exchanges for access tokens</li><li><strong>On failure</strong>: An <code>error</code> parameter describing what went wrong</li><li><strong>Security parameters</strong>: The <code>state</code> value for CSRF protection</li></ul><p>For web applications, this callback is typically a route on your server. But for native applications without a public web server, you need a different approach.</p><h3 id="the-loopback-redirect-pattern" tabindex="-1">The Loopback Redirect Pattern <a class="header-anchor" href="#the-loopback-redirect-pattern" aria-label="Permalink to &quot;The Loopback Redirect Pattern&quot;">​</a></h3><p>Native applications (CLIs, desktop apps) can&#39;t expose public URLs for callbacks. Instead, they use the <strong>loopback interface</strong> — a temporary HTTP server on <code>http://localhost</code> or <code>http://127.0.0.1</code>. This pattern, standardized in <a href="https://www.rfc-editor.org/rfc/rfc8252.html" target="_blank" rel="noreferrer">RFC 8252</a> (OAuth 2.0 for Native Apps), provides several benefits:</p><ul><li><strong>No public exposure</strong>: The callback server only accepts local connections</li><li><strong>Dynamic ports</strong>: Apps can use any available port (e.g., 3000, 8080)</li><li><strong>Automatic cleanup</strong>: The server shuts down immediately after receiving the callback</li><li><strong>Universal support</strong>: Works across all platforms without special permissions</li></ul><p>Here&#39;s how the flow works:</p>',12)),(e(),l(h,null,{default:i(()=>[r(n,{id:"mermaid-69",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20App%20as%20CLI%2FDesktop%20App%0A%20%20%20%20participant%20Browser%20as%20User's%20Browser%0A%20%20%20%20participant%20Auth%20as%20Authorization%20Server%0A%20%20%20%20participant%20Local%20as%20localhost%3A3000%0A%0A%20%20%20%20App-%3E%3ELocal%3A%20Start%20HTTP%20server%0A%20%20%20%20App-%3E%3EBrowser%3A%20Open%20authorization%20URL%0A%20%20%20%20Browser-%3E%3EAuth%3A%20Request%20authorization%0A%20%20%20%20Auth-%3E%3EBrowser%3A%20Show%20consent%20screen%0A%20%20%20%20Browser-%3E%3EAuth%3A%20User%20approves%0A%20%20%20%20Auth-%3E%3EBrowser%3A%20Redirect%20to%20localhost%3A3000%2Fcallback%3Fcode%3Dxyz%0A%20%20%20%20Browser-%3E%3ELocal%3A%20GET%20%2Fcallback%3Fcode%3Dxyz%0A%20%20%20%20Local-%3E%3EApp%3A%20Capture%20code%0A%20%20%20%20App-%3E%3ELocal%3A%20Shutdown%20server%0A%20%20%20%20Local-%3E%3EBrowser%3A%20Show%20success%20page%0A"})]),fallback:i(()=>s[0]||(s[0]=[a(" Loading... ",-1)])),_:1})),s[5]||(s[5]=t("h3",{id:"security-best-practices",tabindex:"-1"},[a("Security Best Practices "),t("a",{class:"header-anchor",href:"#security-best-practices","aria-label":'Permalink to "Security Best Practices"'},"​")],-1)),s[6]||(s[6]=t("p",null,"OAuth 2.0 for native apps requires additional security measures:",-1)),s[7]||(s[7]=t("p",null,[t("strong",null,"Proof Key for Code Exchange (PKCE)"),a(" - "),t("a",{href:"https://www.rfc-editor.org/rfc/rfc7636.html",target:"_blank",rel:"noreferrer"},"RFC 7636"),a(" mandates using PKCE for public clients (those without client secrets). PKCE prevents authorization code interception attacks by binding the code exchange to a cryptographic challenge.")],-1)),(e(),l(h,null,{default:i(()=>[r(n,{id:"mermaid-79",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20App%20as%20Native%20App%0A%20%20%20%20participant%20Browser%0A%20%20%20%20participant%20Auth%20as%20Auth%20Server%0A%0A%20%20%20%20Note%20over%20App%3A%20Generate%20code_verifier%0A%20%20%20%20Note%20over%20App%3A%20Hash%20to%20create%20code_challenge%0A%0A%20%20%20%20App-%3E%3EBrowser%3A%20Open%20%2Fauthorize%3Fcode_challenge%3D...%0A%20%20%20%20Browser-%3E%3EAuth%3A%20Authorization%20request%20with%20challenge%0A%20%20%20%20Auth-%3E%3EAuth%3A%20Store%20challenge%0A%20%20%20%20Auth-%3E%3EBrowser%3A%20Redirect%20with%20code%0A%20%20%20%20Browser-%3E%3EApp%3A%20Return%20code%0A%0A%20%20%20%20App-%3E%3EAuth%3A%20POST%20%2Ftoken%20with%20code%20%2B%20verifier%0A%20%20%20%20Auth-%3E%3EAuth%3A%20Verify%3A%20hash(verifier)%20%3D%3D%20challenge%0A%20%20%20%20Auth-%3E%3EApp%3A%20Return%20access%20token%0A"})]),fallback:i(()=>s[1]||(s[1]=[a(" Loading... ",-1)])),_:1})),s[8]||(s[8]=o(`<p><strong>State Parameter</strong> - A random value that prevents CSRF attacks. Your app generates this value, includes it in the authorization request, and validates it in the callback.</p><p><strong>Dynamic Client Registration (DCR)</strong> - <a href="https://www.rfc-editor.org/rfc/rfc7591.html" target="_blank" rel="noreferrer">RFC 7591</a> allows apps to register OAuth clients on-the-fly without pre-configuration. This is particularly useful for MCP servers where users shouldn&#39;t need to manually register OAuth applications.</p><h2 id="how-oauth-callback-solves-it" tabindex="-1">How OAuth Callback Solves It <a class="header-anchor" href="#how-oauth-callback-solves-it" aria-label="Permalink to &quot;How OAuth Callback Solves It&quot;">​</a></h2><p>OAuth Callback eliminates the boilerplate of implementing loopback redirects. Instead of manually managing servers, ports, and browser launches, you get a complete solution in one function call.</p><h3 id="core-functionality" tabindex="-1">Core Functionality <a class="header-anchor" href="#core-functionality" aria-label="Permalink to &quot;Core Functionality&quot;">​</a></h3><p>The library handles the entire OAuth callback flow:</p><ol><li><strong>Starts a localhost HTTP server</strong> on your specified port</li><li><strong>Opens the user&#39;s browser</strong> to the authorization URL</li><li><strong>Captures the callback</strong> with the authorization code</li><li><strong>Returns the result</strong> as a clean JavaScript object</li><li><strong>Shuts down the server</strong> automatically</li></ol><h3 id="zero-configuration-example" tabindex="-1">Zero Configuration Example <a class="header-anchor" href="#zero-configuration-example" aria-label="Permalink to &quot;Zero Configuration Example&quot;">​</a></h3><p>Here&#39;s a complete OAuth flow in just 6 lines:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { getAuthCode } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;oauth-callback&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getAuthCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line highlighted"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;https://github.com/login/oauth/authorize?client_id=xxx&amp;redirect_uri=http://localhost:3000/callback&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Authorization code:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, result.code);</span></span></code></pre></div><p>That&#39;s it. No server setup, no browser management, no cleanup code.</p><h3 id="cross-runtime-support" tabindex="-1">Cross-Runtime Support <a class="header-anchor" href="#cross-runtime-support" aria-label="Permalink to &quot;Cross-Runtime Support&quot;">​</a></h3><p>OAuth Callback uses modern Web Standards APIs (Request, Response, URL) that work identically across:</p><ul><li><strong>Node.js 18+</strong> - Native fetch and Web Streams support</li><li><strong>Deno</strong> - First-class Web Standards implementation</li><li><strong>Bun</strong> - High-performance runtime with built-in APIs</li></ul><p>This means your OAuth code is portable across runtimes without modifications.</p><h3 id="mcp-integration" tabindex="-1">MCP Integration <a class="header-anchor" href="#mcp-integration" aria-label="Permalink to &quot;MCP Integration&quot;">​</a></h3><p>For Model Context Protocol applications, OAuth Callback provides the <code>browserAuth()</code> provider that integrates seamlessly with the MCP SDK:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-ZNW5m" id="tab-T-HT9ac" checked><label data-title="MCP with OAuth Callback" for="tab-T-HT9ac">MCP with OAuth Callback</label><input type="radio" name="group-ZNW5m" id="tab-q6X0SZz"><label data-title="Namespace Import" for="tab-q6X0SZz">Namespace Import</label></div><div class="blocks"><div class="language-typescript vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { browserAuth, fileStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;oauth-callback/mcp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Client } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@modelcontextprotocol/sdk/client/index.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { StreamableHTTPClientTransport } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@modelcontextprotocol/sdk/client/streamableHttp.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> authProvider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> browserAuth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  store: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fileStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Persist tokens to ~/.mcp/tokens.json</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  scope: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;read write&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Use directly with MCP transports</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> transport</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> StreamableHTTPClientTransport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://mcp.example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { authProvider },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { mcp } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;oauth-callback&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Client } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@modelcontextprotocol/sdk/client/index.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> authProvider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mcp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">browserAuth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  store: mcp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fileStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  scope: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;read write&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></div></div><div class="tip custom-block"><p class="custom-block-title">MCP Integration Features</p><p>The MCP integration handles:</p><ul><li><strong>Dynamic Client Registration</strong> when supported by the server</li><li><strong>Token persistence</strong> with <code>fileStore()</code> or ephemeral <code>inMemoryStore()</code></li><li><strong>Automatic token refresh</strong> when tokens expire</li><li><strong>Multiple app namespace support</strong> via <code>storeKey</code> option</li></ul></div><h2 id="when-to-use-oauth-callback" tabindex="-1">When to Use OAuth Callback <a class="header-anchor" href="#when-to-use-oauth-callback" aria-label="Permalink to &quot;When to Use OAuth Callback&quot;">​</a></h2><h3 id="perfect-for" tabindex="-1">Perfect For <a class="header-anchor" href="#perfect-for" aria-label="Permalink to &quot;Perfect For&quot;">​</a></h3><p>OAuth Callback is ideal when:</p><ul><li><strong>You control the user&#39;s machine</strong> - CLI tools, desktop apps, development tools</li><li><strong>You can open a browser</strong> - The user has a default browser configured</li><li><strong>You need quick setup</strong> - No server infrastructure or complex configuration</li><li><strong>You&#39;re building MCP clients</strong> - Direct integration with Model Context Protocol SDK</li></ul><h3 id="consider-alternatives-when" tabindex="-1">Consider Alternatives When <a class="header-anchor" href="#consider-alternatives-when" aria-label="Permalink to &quot;Consider Alternatives When&quot;">​</a></h3><p><strong>Device Authorization Flow</strong> (<a href="https://www.rfc-editor.org/rfc/rfc8628.html" target="_blank" rel="noreferrer">RFC 8628</a>) might be better if:</p><ul><li><strong>No browser access</strong> - SSH sessions, headless servers, CI/CD environments</li><li><strong>Remote terminals</strong> - The auth happens on a different device than the app</li><li><strong>Input-constrained devices</strong> - Smart TVs, IoT devices without keyboards</li></ul><p>The Device Flow shows a code to the user that they enter on another device, eliminating the need for a browser on the same machine. However, it requires OAuth provider support and a more complex user experience.</p>`,27)),(e(),l(h,null,{default:i(()=>[r(n,{id:"mermaid-255",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20subgraph%20%22OAuth%20Callback%20Flow%22%0A%20%20%20%20%20%20%20%20A1%5BCLI%20App%5D%20--%3E%7COpens%20browser%7C%20B1%5BAuth%20Page%5D%0A%20%20%20%20%20%20%20%20B1%20--%3E%7CUser%20authorizes%7C%20C1%5Blocalhost%3A3000%2Fcallback%5D%0A%20%20%20%20%20%20%20%20C1%20--%3E%7CReturns%20code%7C%20A1%0A%20%20%20%20%20%20%20%20A1%20--%3E%7CExchange%20code%7C%20D1%5BAccess%20Token%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Device%20Authorization%20Flow%22%0A%20%20%20%20%20%20%20%20A2%5BCLI%20App%5D%20--%3E%7CRequest%20device%20code%7C%20B2%5BAuth%20Server%5D%0A%20%20%20%20%20%20%20%20B2%20--%3E%7CReturns%20code%20%2B%20URL%7C%20A2%0A%20%20%20%20%20%20%20%20A2%20--%3E%7CDisplay%20to%20user%7C%20C2%5B%22User%20Code%3A%20ABCD-1234%22%5D%0A%20%20%20%20%20%20%20%20C2%20--%3E%7CUser%20enters%20on%20phone%2Flaptop%7C%20D2%5BAuth%20Page%5D%0A%20%20%20%20%20%20%20%20D2%20--%3E%7CUser%20authorizes%7C%20E2%5BAuth%20Server%5D%0A%20%20%20%20%20%20%20%20A2%20--%3E%7CPoll%20for%20token%7C%20E2%0A%20%20%20%20%20%20%20%20E2%20--%3E%7CReturns%20token%7C%20F2%5BAccess%20Token%5D%0A%20%20%20%20end%0A"})]),fallback:i(()=>s[2]||(s[2]=[a(" Loading... ",-1)])),_:1})),s[9]||(s[9]=o(`<h2 id="security-considerations" tabindex="-1">Security Considerations <a class="header-anchor" href="#security-considerations" aria-label="Permalink to &quot;Security Considerations&quot;">​</a></h2><p>OAuth Callback implements security best practices by default:</p><div class="info custom-block"><p class="custom-block-title">Security Features</p><ul><li><strong>Localhost-only binding</strong> - The callback server only accepts connections from <code>127.0.0.1</code> or <code>::1</code>, preventing remote access attempts.</li><li><strong>Automatic cleanup</strong> - The HTTP server shuts down immediately after receiving the callback, minimizing the attack surface window.</li><li><strong>No persistent state</strong> - Server is ephemeral and leaves no traces after completion.</li></ul></div><div class="warning custom-block"><p class="custom-block-title">Always Validate State</p><p>Always validate the <code>state</code> parameter returned in the callback matches what you sent:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> state</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> crypto.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">randomUUID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> authUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`https://example.com/authorize?state=\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&amp;...\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getAuthCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(authUrl);</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (result.state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state) {</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;State mismatch - possible CSRF attack&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></div><details class="details custom-block"><summary>Proof Key for Code Exchange (PKCE) Implementation</summary><p>For public clients, implement Proof Key for Code Exchange as required by <a href="https://www.rfc-editor.org/rfc/rfc7636.html" target="_blank" rel="noreferrer">RFC 7636</a>:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createHash, randomBytes } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;crypto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> verifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;base64url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> challenge</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createHash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sha256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(verifier).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">digest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;base64url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Include challenge in authorization request</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> authUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`https://example.com/authorize?code_challenge=\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">challenge</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&amp;code_challenge_method=S256&amp;...\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Include verifier in token exchange</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> tokenResponse</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tokenUrl, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> URLSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    code: result.code,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    code_verifier: verifier,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ... other parameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></details><p><strong>Token storage choices</strong> - Choose storage based on your security requirements:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-kB1Ig" id="tab-QblHKZp" checked><label data-title="Ephemeral Storage" for="tab-QblHKZp">Ephemeral Storage</label><input type="radio" name="group-kB1Ig" id="tab-hl_mAns"><label data-title="Persistent Storage" for="tab-hl_mAns">Persistent Storage</label></div><div class="blocks"><div class="language-typescript vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Tokens lost on restart (more secure)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { browserAuth, inMemoryStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;oauth-callback/mcp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> authProvider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> browserAuth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  store: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inMemoryStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Tokens saved to disk (convenient)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { browserAuth, fileStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;oauth-callback/mcp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> authProvider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> browserAuth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  store: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fileStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;~/.myapp/tokens.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></div></div><h2 id="requirements-and-registration" tabindex="-1">Requirements and Registration <a class="header-anchor" href="#requirements-and-registration" aria-label="Permalink to &quot;Requirements and Registration&quot;">​</a></h2><h3 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h3><details class="details custom-block"><summary>System Requirements</summary><table tabindex="0"><thead><tr><th>Requirement</th><th>Details</th></tr></thead><tbody><tr><td><strong>Runtime</strong></td><td>Node.js 18+, Deno, or Bun</td></tr><tr><td><strong>OAuth Application</strong></td><td>Register your app with the OAuth provider</td></tr><tr><td><strong>Redirect URI</strong></td><td>Configure <code>http://localhost:3000/callback</code> (or your chosen port)</td></tr><tr><td><strong>Browser</strong></td><td>User must have a default browser configured</td></tr><tr><td><strong>Permissions</strong></td><td>Ability to bind to localhost ports</td></tr></tbody></table></details><h3 id="standard-oauth-registration" tabindex="-1">Standard OAuth Registration <a class="header-anchor" href="#standard-oauth-registration" aria-label="Permalink to &quot;Standard OAuth Registration&quot;">​</a></h3><p>Most OAuth providers require pre-registering your application:</p><ol><li>Create an OAuth app in the provider&#39;s developer console</li><li>Set redirect URI to <code>http://localhost:3000/callback</code></li><li>Copy your client ID (and secret if provided)</li><li>Use credentials in your code</li></ol><h3 id="dynamic-client-registration-for-mcp" tabindex="-1">Dynamic Client Registration for MCP <a class="header-anchor" href="#dynamic-client-registration-for-mcp" aria-label="Permalink to &quot;Dynamic Client Registration for MCP&quot;">​</a></h3><p>Some MCP servers support Dynamic Client Registration (<a href="https://www.rfc-editor.org/rfc/rfc7591.html" target="_blank" rel="noreferrer">RFC 7591</a>), eliminating pre-registration:</p><div class="tip custom-block"><p class="custom-block-title">No Pre-Registration Required</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line highlighted"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// No client_id or client_secret needed!</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> authProvider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> browserAuth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  scope: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;read write&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  store: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fileStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></div><p>The Notion MCP example demonstrates this — the server automatically registers your client on first use. This greatly simplifies distribution of MCP-enabled tools.</p>`,17)),(e(),l(h,null,{default:i(()=>[r(n,{id:"mermaid-402",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20subgraph%20%22Traditional%20OAuth%20Setup%22%0A%20%20%20%20%20%20%20%20A%5BDeveloper%5D%20--%3E%7C1%20Register%20app%7C%20B%5BOAuth%20Provider%5D%0A%20%20%20%20%20%20%20%20B%20--%3E%7C2%20Get%20client_id%7C%20A%0A%20%20%20%20%20%20%20%20A%20--%3E%7C3%20Embed%20client_id%20in%20app%7C%20D%5BCLI%20App%5D%0A%20%20%20%20%20%20%20%20A%20--%3E%7C4%20Distribute%20app%7C%20C%5BUser%5D%0A%20%20%20%20%20%20%20%20C%20--%3E%7C5%20Runs%20app%20to%20authenticate%7C%20D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Dynamic%20Client%20Registration%22%0A%20%20%20%20%20%20%20%20E%5BUser%5D%20--%3E%7C1%20Run%20app%7C%20F%5BCLI%20App%5D%0A%20%20%20%20%20%20%20%20F%20--%3E%7C2%20Auto-register%7C%20G%5BOAuth%20Provider%5D%0A%20%20%20%20%20%20%20%20G%20--%3E%7C3%20Return%20credentials%7C%20F%0A%20%20%20%20%20%20%20%20F%20--%3E%7C4%20Complete%20auth%7C%20H%5BReady%20to%20use!%5D%0A%20%20%20%20end%0A%0A%20%20%20%20style%20H%20fill%3A%233498DB%0A"})]),fallback:i(()=>s[3]||(s[3]=[a(" Loading... ",-1)])),_:1}))])}const F=p(d,[["render",u]]);export{C as __pageData,F as default};
